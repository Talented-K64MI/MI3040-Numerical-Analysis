#include <bits/stdc++.h>
#define  eps 1.0e-6
#define  eta 1.0e-4
#define  max 1.0e6
#define  pi  3.14159265
using namespace std;
double  a=-10,
		b= 10,
		step=0.00001;
int     sign,dem=0;
//------------------------------------------------------------------//
/*double power(double a, int m, int n)  //Luy thua voi so mu huu ti
{
	double  p=pow(a,m),
            q=1/(n*1.0);
    if ((p<0)&&(n%2!=0))
            return (-pow(-p,q));
    else
            return pow(p,q);
}*/
//----------------------------------//
double f(double x)  //Nhap ham f(x)
{
	return atan(x)+cos(x)+5;
}
//------------------------------------------//
double f1(double x0)  //Ham tra ve f'(x0)
{
	double dy=f(x0+eps)-f(x0-eps),
		   dx=2*eps;
	return dy/dx;
}
//--------------------------------------------------------//
double fixeta(double x0)  //Ham tra ve eta hop li
{
    double etaa=eta;
    while ((f1(x0)*f1(x0+sign*etaa*f1(x0)))>=0) etaa*=2;
    while ((f1(x0)*f1(x0+sign*etaa*f1(x0)))<=0) etaa/=2;
    return etaa;
    
}
//-----------------------------------------------------------//
double gda(double x0)  //Gradient Desent Asent
{
	double x=x0;
	if (f1(x)==0)    return x;
	if (f1(x)<0)     sign=-1;
	else             sign= 1;
	while (abs(f1(x0))>eps)
	{
		x=x0+sign*fixeta(x0)*f1(x0);
		x0=x;
		if (x0>b)   return b;
		dem++;
	}
	return x;
}
//----------------------------------------------------------------------------------//
void xuli()   //Luu cac gia tri x tai 2 dau mut a, b va f'(x)=0;
             //Xuat chi so dau tien va cuoi cung cua map lll vi tri cua min va max
{
	map <double, double> save;
	map <double, double>::iterator k, kmin, kmax;
	double i=a;
	//--------------------------//
	save[f(a)]=a,
	save[f(b)]=b;
    //--------------------------//
    while (i<b)
    {
        i=gda(i);
        save[f(i)]=i;
        i+=step;
    }
	kmin=save.begin();
	kmax=save.end();
	kmax--;
	printf("Min cua f(x) trong khoang [%5.2f,%5.2f] tai: m (%5.5f,%5.5f)\n",a,b,kmin->second,kmin->first);
	printf("Max cua f(x) trong khoang [%5.2f,%5.2f] tai: M (%5.5f,%5.5f)\n",a,b,kmax->second,kmax->first);
	for (k=save.begin(); k!=save.end(); k++)
	{
		printf("(%5.8f,%5.8f)\n",k->second,k->first);
	}
	//cout<<endl<<fixeta(x0);
	cout<<endl<<endl<<save.size()<<"   "<<dem;
}
//----------------------------//
int main()
{
	xuli();
}
